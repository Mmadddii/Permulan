res <- discretize(x@balioak, cut.points)
new("Atributua",
izena = x@izena,
mota = "categoric",
balioak = res$x.discretized)
})
# Metodoa: DatuMultzoa
#' @export
setMethod("discretize", "DatuMultzoa", function(x, cut.points) {
num_atrib <- Filter(function(a) a@mota == "numeric", x@atributuak)
if (length(num_atrib) == 0) stop("Ez dago zenbakizko atributurik DatuMultzoan.")
# Diskretizatu atributu zenbakizko guztiak
disk_atrib <- lapply(num_atrib, function(a) discretize(a, cut.points))
# Atributu zaharrak eta berriak ordezkatu
beste_atrib <- Filter(function(a) a@mota != "numeric", x@atributuak)
berriak <- c(beste_atrib, disk_atrib)
new("DatuMultzoa",
atributuak = berriak,
klasea = x@klasea)
})
# Atributua adibidea
a <- Atributua("adina", c(20, 30, 40, 50), mota = "numeric")
# Diskretizazioa aplikatu
a_disk <- discretize(a, c(25, 35, 45))
# Emaitzaren egitura ikusi
a_disk
a_disk@balioak
# DatuMultzoa adibidea
df <- data.frame(
adina = c(20, 30, 40, 50),
soldata = c(1000, 2000, 3000, 4000),
sexua = factor(c("M", "F", "F", "M"))
)
dm <- DatuMultzoa(df, klase_izena = "sexua")
# Diskretizatu atributu zenbakizko guztiak
dm_disk <- discretize(dm, c(25, 35, 45))
# Atributu berriak ikusi
lapply(dm_disk@atributuak, function(a) list(izena = a@izena, mota = a@mota, balioak = head(a@balioak)))
dm_disk <- discretize(dm, cut.points)
# Atributu berriak ikusi
lapply(dm_disk@atributuak, function(a) list(izena = a@izena, mota = a@mota, balioak = head(a@balioak)))
dm_disk
# Atributu berriak ikusi
lapply(dm_disk@atributuak, function(a) list(izena = a@izena, mota = a@mota, balioak = head(a@balioak)))
var_col(dm)
z<-var_col(dm)
z
Visualizar_ROC(z)
z<-roc_analisi(dm)
z
Visualizar_ROC(z)
z<-roc_analisi(dm)
b <- Atributua("sexua", factor(c("M", "F", "M", "F", "F")))
z<-roc_analisi(b)
df_test <- data.frame(
balioa = c(0.1, 0.4, 0.35, 0.8, 0.9, 0.2, 0.6, 0.5, 0.7, 0.3),
etiketa = c(FALSE, FALSE, TRUE, TRUE, TRUE, FALSE, TRUE, TRUE, TRUE, FALSE)
)
emaitza <- roc_analisi(df_test)
Visualizar_ROC(emaitza)
Korrelazioak_irudikatu(df)
df <- data.frame(
adina = c(25, 30, 35, 40, 45),
soldata = c(1200, 1500, 2000, 2500, 3000),
altuera = c(1.60, 1.70, 1.72, 1.75, 1.80),
pisua = c(50, 60, 68, 75, 80)
)
Korrelazioak_irudikatu(df)
df <- data.frame(
df <- data.frame(
adina = c(20, 25, 30, 35, 40, 45, 50, 55, 60, 65),
soldata = c(1200, 1500, 1600, 2000, 2300, 2600, 2800, 3100, 3500, 3900),
altuera = c(1.55, 1.62, 1.68, 1.70, 1.75, 1.78, 1.79, 1.80, 1.82, 1.83),
pisua = c(70, 68, 72, 74, 78, 79, 85, 88, 90, 92),
zoriontasuna = c(8, 7, 6, 5, 5, 4, 3, 3, 2, 2))
kor <- korrelazio_matrizea(df)
print(kor)
Korrelazioak_irudikatu(df)
df <- data.frame(
adina = c(20, 25, 30, 35, 40, 45, 50, 55, 60, 65),
soldata = c(1200, 1500, 1600, 2000, 2300, 2600, 2800, 3100, 3500, 3900),
altuera = c(1.55, 1.62, 1.68, 1.70, 1.75, 1.78, 1.79, 1.80, 1.82, 1.83),
pisua = c(70, 68, 72, 74, 78, 79, 85, 88, 90, 92),
zoriontasuna = c(8, 7, 6, 5, 5, 4, 3, 3, 2, 2))
kor <- korrelazio_matrizea(df)
print(kor)
Korrelazioak_irudikatu(df)
# 4. Irudia sortu
ggplot2::ggplot(Kor_plot, ggplot2::aes(x = Aldagaia1, y = Aldagaia2, fill = Balioa)) +
ggplot2::geom_tile(color = "white") +
ggplot2::scale_fill_gradientn(
colors = c("blue", "white", "yellow", "orange", "red"),
values = scales::rescale(c(-1, 0, 0.7, 0.9, 1)),
limits = c(-1, 1),
name = "Korrelazioa"
)+
ggplot2::theme_bw() +
ggplot2::theme(panel.border = ggplot2::element_blank(),
panel.grid = ggplot2::element_blank(),
axis.ticks = ggplot2::element_blank(),
axis.text.x = ggplot2::element_text(angle = 45, hjust = 1)) +
ggplot2::ggtitle("Korrelazioen Irudikapena")
devtools::load_all(".")
rm(list = ls())
devtools::load_all(".")
devtools::load_all(".")
devtools::document()
devtools::document()
devtools::load_all(".")
?discretizeEW
.rs.restartR()       # RStudio-ren sesioa berrabiarazi
devtools::clean_dll() # aurreko DLL-ak garbitu
devtools::document()  # dokumentazioa berriro sortu
devtools::test
devtools::document()  # dokumentazioa berriro sortu
devtools::load_all(".")
devtools::test()
library(Permulan)
df <- data.frame(
adina = c(20, 25, 30, 35, 40, 45, 50, 55, 60, 65),
soldata = c(1200, 1500, 1600, 2000, 2300, 2600, 2800, 3100, 3500, 3900),
altuera = c(1.55, 1.62, 1.68, 1.70, 1.75, 1.78, 1.79, 1.80, 1.82, 1.83),
pisua = c(70, 68, 72, 74, 78, 79, 85, 88, 90, 92),
zoriontasuna = c(8, 7, 6, 5, 5, 4, 3, 3, 2, 2))
kor <- korrelazio_matrizea(df)
print(kor)
Korrelazioak_irudikatu(df)
?var_col
var_col(df)
ilter_metrics(df, var_min = 1, entropy_min = 0.5)
filter_metrics(df, var_min = 1, entropy_min = 0.5)
filter_metrics(df, var_min = 0, entropy_min = 0.5)
filter_metrics(df, var_min = 1, entropy_min = 0.5)
filter_metrics(df, var_min = 0.5, entropy_min = 0.5)
filter_metrics(df, var_min = 0.5, entropy_min = 3)
filter_metrics(df, var_min = 0.5, entropy_min = 40)
filter_metrics(df, var_min = 40, entropy_min = 40)
dt <- data.frame(
Sexua = factor(c("Gizona", "Emakumea", "Gizona", "Emakumea", "Gizona", "Gizona")),
Kolorea = factor(c("Urdina", "Gorria", "Urdina", "Gorria", "Berdea", "Urdina")))
informazio_mutuoa(df$Sexua, df$Kolorea)
filter_metrics(df, var_min = 0, entropy_min = 0, auc_min = 0, klase = NULL)
filter_metrics(df, var_min = 0, entropy_min = 5, auc_min = 0, klase = NULL)
filter_metrics(df, var_min = 1, entropy_min = 5, auc_min = 0, klase = NULL)
filter_metrics(df, var_min = 1, entropy_min = 5, auc_min = 0, klase = NULL)
standardize(df)
normalize(df)
devtools::install()
var_col(df)
bariantza<-var_col(df)
print(bariantza)
# Compatibilidad: aceptar ambos nombres (clase o klase)
if (!is.null(klase) && is.null(clase)) {
clase <- klase
}
?filter_metrics
##############################################################
# Metodoa: data.frame
##############################################################
#' @export
setMethod("filter_metrics", "data.frame", function(x,
var_min = 0,
entropy_min = 0,
auc_min = 0,
clase = NULL,
klase = NULL) {
# Compatibilidad: aceptar ambos nombres (clase o klase)
if (!is.null(klase) && is.null(clase)) {
clase <- klase
}
# --- 1. Atributu numerikoak ---
num_cols <- sapply(x, is.numeric)
if (any(num_cols)) {
vars <- var_col(x[, num_cols, drop = FALSE])
keep_num <- names(vars)[!is.na(vars) & vars >= var_min]
} else {
keep_num <- character(0)
}
# --- 2. Atributu kategorikoak ---
cat_cols <- sapply(x, is.factor)
if (any(cat_cols)) {
ents <- sapply(x[, cat_cols, drop = FALSE], entropy)
keep_cat <- names(ents)[!is.na(ents) & ents >= entropy_min]
} else {
keep_cat <- character(0)
}
# --- 3. AUC kalkulua (klase emanda) ---
if (!is.null(clase)) {
aucs <- sapply(names(x)[num_cols], function(col) {
suppressWarnings({
res <- try(roc_analisi(data.frame(x[[col]], clase)), silent = TRUE)
if (inherits(res, "try-error")) return(NA)
return(res$AUC)
})
})
keep_auc <- names(aucs)[!is.na(aucs) & aucs >= auc_min]
} else {
keep_auc <- character(0)
}
# --- 4. Bateratu ---
keep <- unique(c(keep_num, keep_cat, keep_auc))
keep <- keep[keep %in% names(x)]  # asegurarse de que existen
# --- 5. Balidazioa ---
if (length(keep) == 0) {
message("âš ï¸ Ez da atributurik iragazteko baldintzak betetzen (ninguna columna cumple los filtros).")
return(x[, 0, drop = FALSE])
}
# --- 6. Itzuli filtratutako data.frame-a ---
return(x[, keep, drop = FALSE])
})
df1 <- data.frame(
konstantea = rep(5, 10),         # varianza = 0
aldakorra = 1:10,                # varianza alta
pixka_baino_gehiago = c(1,1,2,2,1,2,1,2,1,2)  # varianza pequeÃ±a
)
# Mantiene solo las columnas con varianza >= 1
filter_metrics(df1, var_min = 1)
var_col(df1)
df1
# Mantiene solo las columnas con varianza >= 1
filter_metrics(df1, var_min = 1)
df1 <- data.frame(
konstantea = rep(5, 10),         # varianza = 0
aldakorra = 1:10,                # varianza alta
pixka_baino_gehiago = c(1,1,2,2,1,2,1,2,1,2)  # varianza pequeÃ±a
)
var_col(df1)
# Bariantza >= 1 bakarrik duten aldagaiak gorde
filter_metrics(df1, var_min = 1)
df1 <- data.frame(
konstantea = rep(5, 10),
aldakorra = 1:10,
txikia = c(1,1,2,2,1,2,1,2,1,2)
)
f
df_auc <- data.frame(
balio_on = c(1:10) + rnorm(10, 0, 0.5),
balio_txar = rnorm(10, 5, 1),
klase = c(rep(TRUE, 5), rep(FALSE, 5))
)
# Filtrado con umbral de AUC
# (mantendremos solo las variables con AUC >= 0.7)
df_filtratua <- filter_metrics(df_auc,
var_min = 0,
entropy_min = 0,
auc_min = 0.7,
klase = df_auc$klase)
df_filtratua
roc_analisi(df_auc)
roc_analisi(df_aucdf_auc$klase)
roc_analisi(df_auc$klase)
df_auc <- data.frame(
balio_txar = rnorm(10, 5, 1),
klase = c(rep(TRUE, 5), rep(FALSE, 5))
)
roc_analisi(df_auc)
# Filtrado con umbral de AUC
# (mantendremos solo las variables con AUC >= 0.7)
df_filtratua <- filter_metrics(df_auc,
var_min = 0,
entropy_min = 0,
auc_min = 0.6,
klase = df_auc$klase)
df_filtratua
df_auc <- data.frame(
balio_on = c(1:10) + rnorm(10, 0, 0.5),
klase = c(rep(TRUE, 5), rep(FALSE, 5))
)
# Filtrado con umbral de AUC
# (mantendremos solo las variables con AUC >= 0.7)
df_filtratua <- filter_metrics(df_auc,
var_min = 0,
entropy_min = 0,
auc_min = 0.6,
klase = df_auc$klase)
df_filtratua
roc_analisi(df_auc)
df_auc <- data.frame(
balio_on = c(1:10) + rnorm(10, 0, 0.5),
klase = rep(FALSE, 5), c(rep(TRUE, 5))
)
# Filtrado con umbral de AUC
# (mantendremos solo las variables con AUC >= 0.7)
df_filtratua <- filter_metrics(df_auc,
var_min = 0,
entropy_min = 0,
auc_min = 0.6,
klase = df_auc$klase)
df_filtratua
roc_analisi(df_auc)
df_auc <- data.frame(
adina = c(20, 25, 30, 35, 40, 45, 50, 55, 60, 65),
soldata = c(1000, 1200, 1500, 2000, 2300, 2600, 2800, 3100, 3500, 3900),
pisua = c(70, 68, 72, 74, 78, 79, 85, 88, 90, 92),
zoriontasuna = c(8, 7, 6, 5, 5, 4, 3, 3, 2, 2),
klase = c(FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE)
)
# Adibidez, 'adina' aldagaiaren AUC kalkulatzen dugu
roc_result <- roc_analisi(df_auc[, c("adina", "klase")])
print(roc_result)
Visualizar_ROC(roc_result)
# Kurbaren puntu batzuk erakusteko
head(roc_result$curva)
# Kurbaren puntu batzuk erakusteko
head(roc_result$curva)
# Kasu honetan, AUC minimoa 0.6 jarri
df_filtratua <- filter_metrics(df_auc, auc_min = 0.6, klase = df_auc$klase)
cat("\nðŸ” Filtratutako datasetaren atributuak:\n")
print(names(df_filtratua))
cat("\nHasierako datasetaren zutabeak:\n")
print(names(df_auc))
cat("\nFiltratutako datasetaren zutabeak (AUC >= 0.6):\n")
print(names(df_filtratua))
# Kasu honetan, AUC minimoa 0.6 jarri
df_filtratua <- filter_metrics(df_auc, auc_min = 0.99, klase = df_auc$klase)
cat("\nðŸ” Filtratutako datasetaren atributuak:\n")
print(names(df_filtratua))
df_ent <- data.frame(
kol1 = factor(c("A", "A", "A", "A", "A")),   # Entropia = 0 (balio bakarra)
kol2 = factor(c("A", "B", "A", "B", "A")),   # Entropia ertaina
kol3 = factor(c("X", "Y", "Z", "X", "Y")))
entropy_by_column(df_ent)
# 2ï¸âƒ£ Aplikatu filtraketa entropiaren arabera (adib. entropy_min = 0.8)
df_ent_filtratua <- filter_metrics(df_ent, entropy_min = 0.8)
df_ent_filtratua
emaitza
df_auc <- data.frame(
aldagaia = c(0.1, 0.4, 0.35, 0.8, 0.9, 0.2, 0.6, 0.5, 0.7, 0.3),
etiketa  = c(FALSE, FALSE, TRUE, TRUE, TRUE, FALSE, TRUE, TRUE, TRUE, FALSE)
)
roc_ema <- roc_analisi(df_auc)
roc_ema$AUC
df_auc_filtratua <- filter_metrics(df_auc, auc_min = 0.6, klase = df_auc$etiketa)
df_auc_filtratua
devtools::load_all(".")
discretizeEW(c(1,2,3,4,5), 2)
entropy(factor(c("A","B","A","C")))
filter_metrics(df_ejemplo, var_min=1)
devtools::document()
devtools::install()
library(Permulan)
ls("package:Permulan")
remove.packages("Permulan")
devtools::clean_dll()
devtools::install(build_vignettes = FALSE)
library(Permulan)
remove.packages("Permulan")
.libPaths()
devtools::clean_dll()
devtools::install(build_vignettes = FALSE, args = c('--no-lazy'))
library(Permulan)
dir.create(Sys.getenv("R_LIBS_USER"), recursive = TRUE, showWarnings = FALSE)
Sys.getenv("R_LIBS_USER")
.libPaths(Sys.getenv("R_LIBS_USER"))
.libPaths()
remove.packages("Permulan", lib = "C:/Programak/R-4.5.1/library")
devtools::install(build_vignettes = FALSE, force = TRUE)
system.file(package = "Permulan")
library(Permulan)
ls("package:Permulan")
devtools::test()
example(discretizeEW)
example(filter_metrics)
example(entropy)
devtools::check()
example(Korrelazioak_irudikatu)
devtools::document()
example(Korrelazioak_irudikatu)
devtools::document()
devtools::document()
example(Korrelazioak_irudikatu)
devtools::document()
devtools::document()
devtools::install()
example(Korrelazioak_irudikatu)
devtools::document()
devtools::install()
tools::showNonASCIIfile("R/05filtraketa.R")
tools::showNonASCIIfile("R/05filtraketa.R")
devtools::document()
devtools::install()
#' @importFrom graphics abline
#' @importFrom methods new
#' @importFrom stats cor quantile sd var
#' @import ggplot2
#' @import reshape2
#' @import scales
NULL
#' @title Korrelazioen irudikapena
#' @description
#' Dataset baten korrelazio-matrizea edo informazio mutuala irudikatzen du `ggplot2` erabiliz.
#' Zenbakizko aldagaietarako korrelazioak kalkulatzen dira.
#' *Adi!!!* Jatorrizko datuak sartu behar dira, funtzioak falkulatzen ditu korrelazioak eta bertatik irudikatzen ditu.
#'
#' @param M Data.frame edo matrize bat, non zutabe guztiak zenbakizkoak diren.
#'
#' @return Korrelazio-matrizearen heatmap bat bistaratzen du.
#'
#' @examples
#' df <- data.frame(
#'   adina = c(20, 25, 30, 35, 40, 45, 50),
#'   soldata = c(5000, 4000, 3000, 2000, 1000, 800, 600),
#'   altuera = c(1.60, 1.65, 1.70, 1.75, 1.78, 1.82, 1.85)
#' )
#' Korrelazioak_irudikatu(df)
#'
#' @export
Korrelazioak_irudikatu <- function(M) {
if (!requireNamespace("ggplot2", quietly = TRUE) ||
!requireNamespace("reshape2", quietly = TRUE)) {
stop("Funtzio honek 'ggplot2' eta 'reshape2' paketak behar ditu. Instalatu lehenik.")
}
if (!all(sapply(M, is.numeric))) {
stop("Zutabe guztiak zenbakizkoak izan behar dute!")
}
Kor <- cor(M, use = "complete.obs")
Kor_plot <- reshape2::melt(Kor)
colnames(Kor_plot) <- c("Aldagaia1", "Aldagaia2", "Balioa")
ggplot2::ggplot(Kor_plot, ggplot2::aes(x = Aldagaia1, y = Aldagaia2, fill = Balioa)) +
ggplot2::geom_tile(color = "white") +
ggplot2::scale_fill_gradientn(
colors = c("blue", "white", "yellow", "orange", "red"),
values = scales::rescale(c(-1, 0, 0.7, 0.9, 1)),
limits = c(-1, 1),
name = "Korrelazioa"
) +
ggplot2::theme_bw() +
ggplot2::theme(
panel.border = ggplot2::element_blank(),
panel.grid = ggplot2::element_blank(),
axis.ticks = ggplot2::element_blank(),
axis.text.x = ggplot2::element_text(angle = 45, hjust = 1)
) +
ggplot2::ggtitle("Korrelazioen Irudikapena")
}
##############################################################
#' @title ROC kurbaren irudikapena (AUC plot)
#' @description
#' `roc_analisi()` funtzioaren emaitzetatik ROC kurba marrazten du eta
#' AUC balioa irudikatzen du.
#'
#' @param resultado `roc_analisi()` funtzioaren emaitza (`curva` eta `AUC` elementuak dituen zerrenda)
#'
#' @return ROC kurba marrazten du pantailan.
#'
#' @examples
#' df <- data.frame(
#'   adina = c(20, 25, 30, 35, 40, 45, 50),
#'   soldata = c(5000, 4000, 3000, 2000, 1000, 800, 600),
#'   altuera = c(1.60, 1.65, 1.70, 1.75, 1.78, 1.82, 1.85)
#' )
#' Korrelazioak_irudikatu(df)
#'
#' @export
##############################################################
Visualizar_ROC <- function(resultado) {
if (!("curva" %in% names(resultado)) || !("AUC" %in% names(resultado))) {
stop("Sartutako objektuaren formatua ez da zuzena. 'roc_analisi()' funtziotik ateratakoa izan behar du.")
}
curva <- resultado$curva
AUC <- resultado$AUC
plot(curva$FPR, curva$TPR, type = "l", col = "blue", lwd = 2,
main = paste("ROC Kurba (AUC =", round(AUC, 3), ")"),
xlab = "Positibo Faltxuen Tasa (FPR)",
ylab = "Egiazko Positiboen Tasa (TPR)")
abline(0, 1, col = "red", lty = 2)
}
devtools::document()
devtools::document()
devtools::load_all()
rm(list = c("Korrelazioak_irudikatu", "Visualizar_ROC"))
devtools::load_all()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
# Atributua sortu
a <- Atributua("adina", c(20, 30, 40, 50, 60, 70, 80))
> devtools::document()
# Atributua sortu
a <- Atributua("adina", c(20, 30, 40, 50, 60, 70, 80))
devtools::document()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::document()
devtools::check()
devtools::document()
devtools::document()
devtools::document()
devtools::check()
devtools::document()
devtools::document()
devtools::check()
devtools::build()
install.packages("Permulan_0.1.0.tar.gz", repos = NULL, type = "source")
detach("package:Permulan", unload = TRUE)  # por si estÃ¡ cargado
install.packages("C:/Users/maddi/Desktop/KISA/Sofware mat est/NerePak/Permulan_0.1.0.tar.gz",
repos = NULL, type = "source")
library(Permulan)
